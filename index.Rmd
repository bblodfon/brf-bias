---
title: "Standaridized Boolean Regulatory Function Bias"
author: "[John Zobolas](https://github.com/bblodfon)"
date: "Last updated: `r format(Sys.time(), '%d %B, %Y')`"
description: "Data analyses related to Truth Density bias in standardized boolean regulatory functions"
url: 'https\://bblodfon.github.io/brf-bias/'
github-repo: "bblodfon/brf-bias"
bibliography: references.bib
link-citations: true
site: bookdown::bookdown_site
---

# Input {-}

Libraries used in various scripts and in the analysis on this report:
```{r Load libraries, class.source = 'fold-show', message = FALSE}
library(gtools)
library(dplyr)
library(tibble)
library(tidyr)
library(readr)
library(stringr)
library(usefun)
library(foreach)
library(doParallel)
library(DT)
library(ggplot2)
library(ggpubr)
library(latex2exp)
library(BoolNet)
```

# Boolean Regulatory Functions {-}

**Boolean Regulatory Functions or BRFs** are boolean functions used in the context of biology networks and models.
A mathematical presentation of such a function with $n$ input variables (regulators) would be: $f_{BRF}:\{0,1\}^n \rightarrow \{0,1\}$, where the output of the target biological entity is always $0$ (FALSE/inactive/inhibited) or $1$ (TRUE/active).

## Link operator Boolean Regulatory Functions {-}

Let $f$ be a boolean function $f(x,y):\{0,1\}^n \rightarrow \{0,1\}$, with $m \ge 1$ **activators** $x=\{x_i\}_{i=1}^{m}$ and $k \ge 1$ **inhibitors** $y=\{y_j\}_{j=1}^{k}$, that is a total of $n = m + k$ regulators.
The link operator boolean functions have a (non-DNF) formula representation that partitions the two distinct type of regulators (positive regulators are called *activators*, negative regulators are called *inhibitors*) into two separate groups and connect them with a specific logical operator (which we call the *link operator*).
The presence of the link operator is what forces the condition $m,k \ge 1$ (at least one regulator in each category).
An example of such a function that has been used in the literature is the formula with the `AND-NOT` link operator [@Mendoza2006]:

- `AND-NOT`: $$f_{AND-NOT}(x,y) = \left(\bigvee_{i=1}^{m} x_i\right) \land \lnot \left(\bigvee_{j=1}^{k} y_j\right)$$

A **variation** of this one is the `OR-NOT` link operator function:

- `OR-NOT`: $$f_{OR-NOT}(x,y) = \left(\bigvee_{i=1}^{m} x_i\right) \lor \lnot \left(\bigvee_{j=1}^{k} y_j\right)$$

In theory, we could use any of the known logical operators as a link operator, e.g. `XOR`, `NAND`, etc.

For example, another link operator function is the next one ^[We call it *pairs* function since the intuition behind it is that the function returns *TRUE* if there is at least one pair of regulators consisting of a **present activator** and an **absent inhibitor**]:

- `Pairs`: $$f_{pairs}(x,y) = \bigvee_{\forall (i,j)}^{m,k}(x_i\land \lnot y_j) = \left(\bigvee_{i=1}^{m} x_i\right) \land \left(\bigvee_{j=1}^{k} \lnot y_j\right)$$

:::{.note}
@Cury2019 defined the **consistent boolean regulatory** functions and their respective **complete DNF forms (CDNF)**.

The link operator functions listed above are a subset of these functions, since they respect the regulatory structure in their respective DNF forms (for the *Pairs* function it's evident since it's written first in the DNF - for the *AND-NOT* and *OR-NOT* functions, see their respective DNF forms in the truth density proofs \@ref(prp:and-not-proof) and \@ref(prp:or-not-proof).
:::

## Threshold functions {-}

The **boolean threshold functions** are formulated based on given *pseudo-Boolean* constrains for the regulators.
Thus, the activators and inhibitors are combined in an *additive* manner and not a *combinatorial* one and the **majority rule** defines the value of the function [@Chaouiya2013; @crama2011boolean].

Two simple cases of **threshold** functions are given below ^[Both threshold functions output *TRUE* when the number of present activators is larger than the number of present inhibitors. They differ when equal number of activators and inhibitors are present: in the first, the activators 'win' and thus the output is *TRUE*, whereas in the second the inhibitors *win* and the output is *FALSE*]:

- `Act-win`: $$f_{act-win}(x,y)=\begin{cases}
        1, & \text{for } \sum_{i=1}^{m} x_i \ge \sum_{j=1}^{k} y_j\\
        0, & \text{otherwise}
        \end{cases}$$
- `Inh-win`: $$f_{inh-win}(x,y)=\begin{cases}
        1, & \text{for } \sum_{i=1}^{m} x_i \gt \sum_{j=1}^{k} y_j\\
        0, & \text{otherwise}
        \end{cases}$$

Note that: $f_{inh-win}(x,y) = \lnot f_{act-win}(y,x)$.

:::{.blue-box}
Note that every boolean function has an equivalent combinatorial expression (i.e. the variables are connected with logical operators) and I searched for an analytic formula for the two last threshold functions.
More more info, see this [math.stackexchange question](https://math.stackexchange.com/questions/3767774/identify-boolean-function-that-satisfies-some-constrains/).
:::

# Truth Density Data Analysis {-}

## Data {-}

:::{.blue-box}
*Truth Density (TD)* of a boolean equation/expression/function, given it's equivalent truth table, is the **number of rows that the function is active** divided by **the total number of rows** $(2^n)$.
:::

I created every possible truth table for up to $20$ variables (variables here means *regulators* for us) and calculated the `AND-NOT`, `OR-NOT`, `Pairs`, `Act-win`, `Inh-win` boolean function results for every possible configuration of the number of activators and inhibitors that added up to the number of regulators.
Then, from the truth tables I calculated the **truth density** of each operator for each particular configuration.
For more details see the script [get_stats.R](get_stats.R)

:::{#tr-data}
See part of the data below:
:::
```{r load-data}
stats = readRDS(file = "data/td_stats.rds")

# change names
stats = stats %>% 
  dplyr::rename(td_pairs = td_balance_op, td_act_win = td_exp_act, td_inh_win = td_exp_inh)

DT::datatable(data = stats,
  caption = htmltools::tags$caption("Truth Density Data", style="color:#dd4814; font-size: 18px"),
  options = list(pageLength = 6, scrollX = TRUE, order = list(list(1, "asc")))) %>% 
  formatRound(4:8, digits = 2)
```

## Truth Density formulas {-}

Here we prove the exact formulas for the truth densities in the case of the `AND-NOT` and `OR-NOT` link operator boolean functions.
For both propositions presented, we assume that $f$ is a boolean function $f(x,y):\{0,1\}^n \rightarrow \{0,1\}$, with a total of $n$ regulators/input variables.
We also assume that these regulators are uniquely separated to two distinct groups: $m$ **activators** (positive regulators) $x=\{x_i\}_{i=1}^{m}$ and $k$ **inhibitors** (negative regulators) $y=\{y_j\}_{j=1}^{k}$, with $n = m + k$.

```{proposition, name="AND-NOT Truth Density Formula", label='and-not-proof'}
When a boolean regulatory function $f$ has the form of an *AND-NOT* link operator boolean function:
$f_{AND-NOT}(x,y) = \left(\bigvee_{i=1}^{m} x_i\right) \land \lnot \left(\bigvee_{j=1}^{k} y_j\right)$ with $m \ge 1$ activators and $k \ge 1$ inhibitors, its truth density is $TD_{AND-NOT}=\frac{2^m-1}{2^n} = \frac{1}{2^k}-\frac{1}{2^n}$.
```

```{proof}
Using the distributivity property and De Morgan's law we can re-write $f_{AND-NOT}$ in a DNF form as:
\begin{equation}
\begin{split}
f_{AND-NOT}(x,y) & = \left(\bigvee_{i=1}^{m} x_i\right) \land \lnot \left(\bigvee_{j=1}^{k} y_j\right) \\
                 & = \bigvee_{i=1}^{m} \left( x_i \land \lnot \left( \bigvee_{j=1}^{k} y_j \right) \right) \\ 
                 & = \bigvee_{i=1}^{m} (x_i \land \bigwedge_{j=1}^{k} \lnot y_j) \\ 
                 & = \bigvee_{i=1}^{m} (x_i \land \lnot y_1 \land ... \land \lnot y_k)
\end{split}
\end{equation}

To calculate the $TD_{AND-NOT}$, we need to find the number of rows of the $f_{AND-NOT}$ truth table that result in a *TRUE* output result and divide that by the total number of rows, which is $2^n$ ($n$ regulators/inputs).
Note that $f_{AND-NOT}$, written in it's equivalent DNF form, has exactly $m$ clauses.
Each clause has a unique *TRUE/FALSE* assignment of regulators that makes it *TRUE*.
This happens when the activator of the clause is *TRUE* and all of the inhibitors *FALSE*.
Since the condition for the inhibitors is the same regardless of the clause we are looking at and $f$ is expressed in a DNF form, the *TRUE* outcomes of the function $f$ are defined by all logical assignment combinations of the $m$ activators that have at least one of them being *TRUE* and all inhibitors assigned as *FALSE*.
There are a total of $2^m$ possible $TRUE/FALSE$ logical assignments of the $m$ activators (from all *FALSE* to all *TRUE*) and $f_{AND-NOT}$ becomes *TRUE* on all except one of them (i.e. when all activators are *FALSE*) and the corresponding $2^m-1$ truth table rows have all inhibitors assigned as *FALSE*.
Thus $TD_{AND-NOT}=\frac{2^m-1}{2^n}$.
```

<br>

```{proposition, name="OR-NOT Truth Density Formula", label='or-not-proof'}
When a boolean regulatory function $f$ has the form of an *OR-NOT* link operator boolean function:
$f_{OR-NOT}(x,y) = \left(\bigvee_{i=1}^{m} x_i\right) \lor \lnot \left(\bigvee_{j=1}^{k} y_j\right)$ with $m \ge 1$ activators and $k \ge 1$ inhibitors, its truth density is $TD_{OR-NOT}=\frac{2^n-(2^k-1)}{2^n} = 1 + \frac{1}{2^n} - \frac{1}{2^m}$.
```

```{proof}
Using De Morganâ€™s law we can re-write $f_{OR-NOT}$ in a DNF form as:
\begin{equation}
\begin{split}
f_{OR-NOT}(x,y) & = \left(\bigvee_{i=1}^{m} x_i\right) \lor \lnot \left(\bigvee_{j=1}^{k} y_j\right) \\
                & = \left(\bigvee_{i=1}^{m} x_i\right) \lor \left(\bigwedge_{j=1}^{k} \lnot y_j\right) \\
                & = x_1 \lor x_2 \lor ... \lor x_m \lor (\lnot y_1 \land ... \land \lnot y_k)
\end{split}
\end{equation}

To calculate the $TD_{OR-NOT}$, it's easier to find the number of rows of the $f_{OR-NOT}$ truth table that result in a *FALSE* output result ($R_{false}$), subtract that number from the total number of rows ($2^n$) to get the rows that result in $f$ being *TRUE* and then divide by the total.
Thus $TD_{OR-NOT} = \frac{2^n-R_{false}}{2^n}$.
Note that $f_{OR-NOT}$, written in it's equivalent DNF form, has exactly $m+1$ clauses.
To make $f_{OR-NOT}$ *FALSE*, we first need to assign the $m$ activators as *FALSE* and then it all depends on the logical assignments of the inhibitors $y_i$ that are part of the last clause.
Out of all possible $2^k$ *TRUE/FALSE* logical assignments of the $k$ inhibitors (ranging from all *FALSE* to all *TRUE*) there is **only one that does not make** the last clause of $f_{OR-NOT}$ *FALSE* and that happens when all $k$ inhibitors are *FALSE*.
Thus, $R_{false}=2^k-1$ and $TD_{OR-NOT}=\frac{2^n-(2^k-1)}{2^n}$.
```

### Asymptotic behavior {-}

For a large number of regulators $n$, the truth densities of the `AND-NOT` and `OR-NOT` functions are as follows:

- `AND-NOT`: $$TD_{AND-NOT} = \frac{1}{2^k}-\frac{1}{2^n} \xrightarrow{n \text{ large}} \frac{1}{2^k} \xrightarrow{k \text{ large}}0$$
- `OR-NOT`:  $$TD_{OR-NOT} = 1 + \frac{1}{2^n} - \frac{1}{2^m} \xrightarrow{n \text{ large}} 1-\frac{1}{2^m} \xrightarrow{m \text{ large}} 1$$

:::{.green-box}
For large $n$, the $TD_{AND-NOT}$ depends only **on the number of inhibitors** and tends towards $0$ with increasing number of inhibitors.
Similarly, the $TD_{OR-NOT}$ depends only **on the number of activators** for large $n$ and tends towards $1$ with increasing number of activators.

Thus, in these two cases of link operator functions, **the standardized boolean model parameterization plays a major role in the definition of the biological state of the link operator nodes** - the more regulators/inputs these functions have, the more biased the output result is (towards $0$ or $1$ respectively).
:::

Note that for large $n$, the extreme case of having a TD value equal to $1/2$ is a result of having **only one of the regulators being an inhibitor (resp. activator)** of the `AND-NOT` (resp. `OR-NOT`) equation.

### Validation {-}

We can use the [data above](#tr-data) to validate the [TD formulas](#truth-density-formulas) (up to $n=20$):
```{r validate-formulas, comment=""}
# Validate AND-NOT Truth Density formula
formula_td_and_not = stats %>% 
  mutate(formula_td_and_not = (2^num_act - 1)/(2^num_reg)) %>%
  pull(formula_td_and_not)

all(stats %>% pull(td_and_not) == formula_td_and_not)

# Validate OR-NOT Truth Density formula
formula_td_or_not = stats %>% 
  mutate(formula_td_or_not = (((2^num_act - 1) * (2^num_inh)) + 1)/(2^num_reg)) %>%
  pull(formula_td_or_not)

all(stats %>% pull(td_or_not) == formula_td_or_not)
```

## *AND-NOT* vs *OR-NOT* TD {-#stand-eq-bias}

Comparing the `AND-NOT` and `OR-NOT` truth densities across the number of regulators:
```{r fig-and-or-not, fig.align='center', dpi=300, cache=TRUE, fig.cap="AND-NOT vs OR-NOT Truth Densities across all possible activators and inhibitors combinations up to 20 regulators"}
# tidy up data
stats_and_or = tidyr::pivot_longer(data = stats, cols = c(td_and_not, td_or_not), 
  names_to = "lo", values_to = "td") %>%
  select(num_reg, lo, td) %>%
  mutate(lo = replace(x = lo, list = lo == "td_and_not", values = "AND-NOT")) %>%
  mutate(lo = replace(x = lo, list = lo == "td_or_not", values = "OR-NOT")) %>%
  rename(`Link Operator` = lo)

ggboxplot(data = stats_and_or, x = "num_reg", y = "td", 
  color = "Link Operator", palette = "Set1",
  title = "AND-NOT vs OR-NOT Truth Densities", 
  xlab = "Number of regulators", ylab = "Truth Density") +
  theme(plot.title = element_text(hjust = 0.5))
```

:::{.green-box}
- **The more regulators** there are, the more likely it is that the `AND-NOT` link operator in the boolean equation will result in an **inhibited** target and that the `OR-NOT` link operator in an **active** target.
- For $n>6$ regulators, the points outside the boxplots (with a truth density of $\frac{1}{2}, \frac{1}{4}, 1-\frac{1}{4},\frac{1}{8},1-\frac{1}{8},...$) correspond to the **asymptotic behavior** of the truth density formulas shown [above](#asymptotic-behavior) where there is a large difference between the **number of activators and inhibitors** ($k \ll m$ for the `AND-NOT` case, e.g. $1,2,...$ inhibitors only or $m \ll k$ for the `OR-NOT` case, i.e. $1,2,...$ activators).
:::

We can also check the relation between TD and number of activators and inhibitors in each case.
The following figures demonstrate that the asymptotic behaviour of the truth density of the `AND-NOT` link operator function is largely dependent on the number of **inhibitors** and not on the number of **activators**:
```{r and-not-reg-plot, dpi=300, cache=TRUE, fig.show='hold', out.width='50%', fig.cap="AND-NOT TD vs Number of Activators and Inhibitors"}
ggscatter(data = stats %>% rename(`#Regulators` = num_reg), x = "num_inh", 
  y = "td_and_not", color = "#Regulators",
  ylab = "Truth Density", xlab = "Number of Inhibitors", 
  title = "AND-NOT TD vs Number of Inhibitors") + 
  theme(plot.title = element_text(hjust = 0.5)) +
  ylim(c(0,1))

ggscatter(data = stats %>% rename(`#Regulators` = num_reg), x = "num_act", 
  y = "td_and_not", color = "#Regulators",
  ylab = "Truth Density", xlab = "Number of Activators", 
  title = "AND-NOT TD vs Number of Activators") + 
  theme(plot.title = element_text(hjust = 0.5)) +
  ylim(c(0,1))
```

The reverse situation is true for the `OR-NOT` case: 
```{r or-not-reg-plot, dpi=300, cache=TRUE, fig.show='hold', out.width='50%', fig.cap="OR-NOT TD vs Number of Activators and Inhibitors"}
ggscatter(data = stats %>% rename(`#Regulators` = num_reg), 
  x = "num_inh", y = "td_or_not", color = "#Regulators",
  ylab = "Truth Density", xlab = "Number of Inhibitors", 
  title = "OR-NOT TD vs Number of Inhibitors") + 
  theme(plot.title = element_text(hjust = 0.5)) +
  ylim(c(0,1))

ggscatter(data = stats %>% rename(`#Regulators` = num_reg), 
  x = "num_act", y = "td_or_not", color = "#Regulators",
  ylab = "Truth Density", xlab = "Number of Activators", 
  title = "OR-NOT TD vs Number of Activators") + 
  theme(plot.title = element_text(hjust = 0.5)) +
  ylim(c(0,1))
```

## *Pairs* TD {-}

If we add the `Pairs` TD results to the first plot we have:
```{r fig-and-or-pairs-tds, fig.align='center', dpi=300, cache=TRUE, fig.cap="AND-NOT vs OR-NOT vs Pairs Truth Densities across all possible activators and inhibitors combinations up to 20 regulators"}
# tidy up data
stats_and_or_pairs = tidyr::pivot_longer(data = stats, cols = c(td_and_not, td_or_not, td_pairs), 
  names_to = "lo", values_to = "td") %>%
  select(num_reg, lo, td) %>%
  mutate(lo = replace(x = lo, list = lo == "td_and_not", values = "AND-NOT")) %>%
  mutate(lo = replace(x = lo, list = lo == "td_or_not", values = "OR-NOT")) %>%
  mutate(lo = replace(x = lo, list = lo == "td_pairs", values = "Pairs")) %>%
  rename(`Link Operator` = lo)

ggboxplot(data = stats_and_or_pairs, x = "num_reg", y = "td", 
  color = "Link Operator", palette = "Set1",
  title = "AND-NOT vs OR-NOT vs Pairs Truth Densities", 
  xlab = "Number of regulators", ylab = "Truth Density") +
  theme(plot.title = element_text(hjust = 0.5))
```

:::{.green-box}
- The `Pairs` TD values are closer to the TD values of the `OR-NOT` formula compared to the `AND-NOT` one.
- The `Pairs` is less *biased* compared to the `OR-NOT` link operator, but still for large $n$ (regulators) it practically **makes the target active**.
:::

As we can see in the following two figures, the `Pairs` shows a more balanced dependency between the number of activators and inhibitors:
```{r pairs-reg-plot, dpi=300, cache=TRUE, fig.show='hold', out.width='50%', fig.cap="Pairs TD vs Number of Activators and Inhibitors"}
ggscatter(data = stats %>% rename(`#Regulators` = num_reg), x = "num_inh", 
  y = "td_pairs", color = "#Regulators",
  ylab = "Truth Density", xlab = "Number of Inhibitors", 
  title = "Pairs TD vs Number of Inhibitors") + 
  theme(plot.title = element_text(hjust = 0.5)) +
  ylim(c(0,1))

ggscatter(data = stats %>% rename(`#Regulators` = num_reg), x = "num_act", 
  y = "td_pairs", color = "#Regulators",
  ylab = "Truth Density", xlab = "Number of Activators", 
  title = "Pairs TD vs Number of Activators") + 
  theme(plot.title = element_text(hjust = 0.5)) +
  ylim(c(0,1))
```

## Threshold Functions TD {-}

In contrast, if we check the truth density of the $f_{act-win}(x,y)$ and $f_{inh-win}(x,y)$ boolean functions we have:
```{r fig-two-bool-formulas, fig.align='center', dpi=300, cache=TRUE, fig.cap="Truth Desities of two robust boolean formulas across all possible activators and inhibitors combinations up to 20 regulators"}
# tidy up data
stats_functions = tidyr::pivot_longer(data = stats, cols = c(td_act_win, td_inh_win), 
  names_to = "fun", values_to = "td") %>%
  select(num_reg, fun, td) %>%
  mutate(fun = replace(x = fun, list = fun == "td_act_win", values = "Activators Win")) %>%
  mutate(fun = replace(x = fun, list = fun == "td_inh_win", values = "Inhibitors Win")) %>%
  rename(`Equation Formula` = fun)

ggboxplot(data = stats_functions, x = "num_reg", y = "td",
  color = "Equation Formula", palette = "lancet",
  title = latex2exp::TeX("Truth Densities of $f_{act-win}(x,y)$ and $f_{inh-win}(x,y)$"),
  xlab = "Number of regulators", ylab = "Truth Density") +
  theme(plot.title = element_text(hjust = 0.5)) +
  geom_hline(yintercept = 0.5, linetype="dashed", color = "black")
```

:::{.green-box}
- Both boolean functions show a **large variance of truth densities** irrespective of the number of regulators, since the values inside the boxplots represent the middle $50\%$ of the data and span across the $(0,1)$ range.
- The median truth density values seem to converge to $1/2$ for both formulas and this is how a proper *balanced* boolean function behaves :) less bias to the truth density values for increasing number of regulators results in a more *fair or balanced* boolean formula.
- The median value of truth density for the $f_{act-win}(x,y)$ is always larger than the $f_{inh-win}(x,y)$ (as expected).
:::

## TD Data Distance {-}

We check how close are the truth density values of the different proposed boolean regulatory functions, also compared to the **proportion of activators**, e.g. if a function has $1$ activator and $5$ inhibitors (resp. $5$ activators and $1$ inhibitor) I would expect the boolean regulatory function's output to be statistically more *inhibited* (resp. *activated*).
We find the *euclidean distance* between the different truth density values and show them in a data table:

```{r td-values-distance}
x = rbind(`Proportion of Activators` = stats %>% mutate(act_prop = num_act/num_reg) %>% pull(act_prop),
  `AND-NOT TD` = stats %>% pull(td_and_not),
  `OR-NOT TD` = stats %>% pull(td_or_not),
  `Pairs TD` = stats %>% pull(td_pairs),
  `Act-win TD` = stats %>% pull(td_act_win),
  `Inh-win TD` = stats %>% pull(td_inh_win))

d = dist(x, method = "euclidean")
```

```{r dist-table}
# color `act_prop` column
breaks = quantile(unname(as.matrix(d)[, "Proportion of Activators"]), probs = seq(.05, .95, .05), na.rm = TRUE)
col = round(seq(255, 40, length.out = length(breaks) + 1), 0) %>%
  {paste0("rgb(255,", ., ",", ., ")")} # red

caption.title = "Euclidean Distances between vectors of truth density values (Symmetric)"
DT::datatable(data = d %>% as.matrix(), options = list(dom = "t", scrollX = TRUE),
  caption = htmltools::tags$caption(caption.title, style="color:#dd4814; font-size: 18px")) %>% 
  formatRound(1:6, digits = 3) %>%
  formatStyle(columns = c("Proportion of Activators"), backgroundColor = styleInterval(breaks, col))
```

```{r dist-dendogram, fig.height=7, fig.align='center'}
plot(hclust(dist(d)), main = "Dendogram of Truth Density Distnaces between Various BRFs",
  ylab = "Euclidean Distance", sub = "", xlab = "")
```

:::{.green-box}
- The **threshold functions** have truth densities values that are **closer to the proportion of activators** for a varying number of regulators, compared to the `AND-NOT` and `OR-NOT` formulas.
As such they might represent better candidates for boolean regulatory functions from this (statistical) point of view.
- The TD values of `OR-NOT` and `Pairs` are in general very close (as we've also seen in a previous figure)
:::

# CASCADE 1.0 Data Analysis {-}

## Data {-}

Using [abmlog](https://github.com/druglogics/abmlog) we generated all $2^{23} = 8388608$ possible link operator mutated models for the CASCADE 1.0 topology ($23$ nodes have at least one regulator from each category, i.e. an activator and an inhibitor).
The models are stored in both `.gitsbe` and `.bnet` files in the Zenodo dataset [![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.4022783.svg)](https://doi.org/10.5281/zenodo.4022783) (the `gitsbe` files include also the fixpoint attractors).

:::{.blue-box}
The dataset includes models with $0,1$ or $2$ stable states.
We used the [get_ss_data.R](https://github.com/bblodfon/brf-bias/blob/main/scripts/get_ss_data.R) script to get the **1 stable state data** from the models (a total of $2820224$ models - see [stable state distribution](https://bblodfon.github.io/bool-param-maps/cascade-1-0-general.html#model-stable-state-statistics)) and it's this data we are going to analyze in the next section.
:::

## Parameterization vs Activity {-}

We calculate the `node_stats` object using the [get_node_stats.R](https://github.com/bblodfon/brf-bias/blob/main/scripts/get_node_stats.R) script.
This object includes the **agreement statistics information** for each link operator node (i.e. one that is targeted by both activators and inhibitors).

Load the `node_stats`:
```{r load_node_stats}
node_stats = readRDS(file = "data/node_stats.rds")
```

:::{.note #percent-agreement-note}
We are interested in two variables of interest:

- **Parameterization** of a link operator node: `AND-NOT` (0) vs `OR-NOT` (1)
- **Stable State** of a node: *inhibited* (0) vs *active* (1)

There exist are 4 different possibilities related to 2 cases:

1. `0-0`, `1-1` => parameterization and stable state **match** (e.g. node was parameterized with `AND-NOT` and it's state was inhibited or it had `OR-NOT` and its state was active)
2. `1-0`, `0-1` => parameterization and stable state **differ** (e.g. node had `OR-NOT` and its state was inhibited, or `AND-NOT` and it's state was active)

The **percent Agreement** (or total observed proportionate agreement score) is the number of total matches (case 1 above) divided by the total number of data observations/models.

A more *robust* and *sophisticated* (compared to the percent agreement) statistic is the **Cohen's kappa coefficient** ($\kappa$). 
This statistic is used to measure the extent to which data collectors (raters) assign the same score to the same variable (interrater reliability) and takes into account the possibility of agreement occurring by chance.
In our case **one rater assigns link operator parameterization** (`AND-NOT` or $0$ vs `OR-NOT` or $1$) and **the other stable state activity** $0$ vs $1$).

In the figures showing Cohen's $\kappa$, we draw a horizontal line to indicate the value of $\kappa=0.6$ that corresponds to a *moderate* or *substantial* strength of agreement [@Landis1977; @McHugh2012a]
:::

In the next Figure we show the **percent agreement** for each node:
```{r ss-lo-agreement-prop, fig.align='center', dpi=300, cache=TRUE, fig.cap="Parameterization and Stable State activity agreement"}
node_stats %>% mutate(node = forcats::fct_reorder(node, desc(num_reg))) %>% 
  ggplot(aes(x = node, y = obs_prop_agreement, fill = as.factor(num_reg))) +
    geom_bar(stat = "identity") +
    scale_y_continuous(labels=scales::percent) +
    labs(title = "Agreement between Link Operator Parameterization and Stable State Activity", x = "Target Nodes with both activating and inhibiting regulators", y = "Percent Agreement") +
    theme_classic() + theme(axis.text.x = element_text(angle = 90)) +
    scale_fill_brewer(guide = guide_legend(reverse=TRUE, title = "#Regulators"), palette = "Set1") +
    geom_hline(yintercept = 0.5, linetype = 'dashed')
```

:::{.green-box}
The total barplot area covered (i.e. the **total percent agreement score** so to speak) is **`r node_stats %>% summarise(100 * sum(obs_prop_agreement)/n()) %>% pull()`%**.

The above score means that the is a higher probability than chance to assign a node the `AND-NOT` (resp. `OR-NOT`) link operator in its respective boolean equation and that node at the same time having an inhibited (resp. activated) stable state of $0$ (.resp $1$) in any CASCADE 1.0 link operator parameterized model.
**This suggests that the corresponding boolean formula used is biased**.
:::

In the next figures, we have **separated the nodes to groups based on the number of regulators** and show both percent agreement and Cohen's $\kappa$:
```{r ss-lo-agreement-prop-grouped, warning='FALSE', fig.show='hold', out.width='50%', warning=FALSE, dpi=300, cache=TRUE, fig.cap="Parameterization and Stable State activity agreement. CASCADE 1.0 link operator nodes are grouped based on their respective number of regulators. Both percent agreement and Cohen's k are presented"}
node_stats %>% 
  mutate(num_reg = as.factor(num_reg)) %>%
  ggplot(aes(x = num_reg, y = obs_prop_agreement, fill = num_reg)) + 
    geom_boxplot(show.legend = FALSE) +
    geom_jitter(shape = 19, position = position_jitter(0.2), show.legend = FALSE) +
    scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
    labs(title = "Agreement (parameterization vs stable state activity)", x = "Number of Regulators", y = "Percent Agreement") +
    geom_hline(yintercept = 0.5, linetype = 'dashed', color = "red") +
    theme_classic(base_size = 14) +
    theme(axis.text.x = element_text(size = 15))

node_stats %>% 
  mutate(num_reg = as.factor(num_reg)) %>%
  ggplot(aes(x = num_reg, y = cohen_k, fill = num_reg)) + 
    geom_boxplot(show.legend = FALSE) +
    geom_jitter(shape = 19, position = position_jitter(0.2), show.legend = FALSE) +
    ylim(c(0,1)) +
    labs(title = "Cohen's k (parameterization vs stable state activity)", x = "Number of Regulators", y = latex2exp::TeX("$\\kappa$")) +
    geom_hline(yintercept = 0.6, linetype = 'dashed', color = "red") +
    geom_text(aes(x = 3.4, y = 0.55, label="k = 0.6")) + 
    theme_classic(base_size = 14) +
    theme(axis.text.x = element_text(size = 15))
```

:::{.green-box}
We observe that even for a small number of regulators, the **median percent agreement score is higher than** $0.5$, though the corresponding Cohen's $\kappa$ score seems to be quite variant across the number of regulators.

Since Cohen's $\kappa$ is a more *strict* score to assess agreement between parameterization and stable state activity we conclude that the *truth density bias* of the standardized regulatory functions might not be quite evident from these data (**we need link operator nodes with more regulators**).
:::

Next, we calculate per node, the proportion of link operator assignments that retained their expected (i.e. keeping the same digit) stable state activity (e.g. the proportion of models corresponding to the cases `0-0`/(`0-0` + `0-1`) for the `AND-NOT` link operator - and `1-1`/(`1-1` + `1-0`) for `OR-NOT`):
```{r ss-comp-agreement-props, fig.align='center', dpi=300, cache=TRUE, fig.cap="Parameterization and Stable State activity agreement 2"}
node_stats %>% 
  mutate(and_not_0ss_prop = and_not_0ss_agreement/(and_not_0ss_agreement + and_not_1ss_disagreement)) %>% 
  mutate(or_not_1ss_prop  = or_not_1ss_agreement/(or_not_1ss_agreement + or_not_0ss_disagreement)) %>%
  select(node, num_reg, and_not_0ss_prop, or_not_1ss_prop, active_prop) %>%
  rename(`AND-NOT` = and_not_0ss_prop, `OR-NOT` = or_not_1ss_prop) %>%
  mutate(node = forcats::fct_reorder(node, desc(num_reg))) %>%
  pivot_longer(cols = c(`AND-NOT`, `OR-NOT`)) %>%
  ggplot(aes(x = node, y = value, fill = name)) +
    geom_bar(position = "dodge", stat = "identity") +
    scale_y_continuous(labels=scales::percent) +
    labs(title = "Link Operator Parameterization Agreement with Stable State Activity", 
      x = "Target Nodes with both activating and inhibiting regulators", 
      y = "Percent Agreement") +
    theme_classic() + theme(axis.text.x = element_text(angle = 90)) + 
    scale_fill_brewer(guide = guide_legend(title = "Link Operator"), palette = "Set1") + 
    geom_line(aes(y = active_prop, color = active_prop), group = 1, size = 1.2) +
    scale_color_gradient(labels=scales::percent, low="grey", high="green", 
      name = "%Models:active node", limits = c(0,1)) + 
    theme(legend.title = element_text(size = 10))
```

:::{.green-box}
- Higher proportional activity for a node correlates with higher `OR-NOT`-activated state agreement.
- `LRP_f` has 4 activators and 1 inhibitor and from the previous [TD data table](#tr-data) we have that: $TD_{AND-NOT,4+1}=0.469$, $TD_{OR-NOT,4+1}=0.969$, numbers which correspond really well with the percent agreement scores found across all the CASCADE 1.0 models.
- `TSC_f` and `mTORC2_c` are always found inhibited and thus the agreement with the `AND-NOT`-inhibited state is perfect and the `OR-NOT`-activated state agreement zero.
- `TSC_f` has 1 activator and 4 inhibitors, which corresponds well to it's total inhibition profile in all the models (with significantly more inhibitors, there is a higher probability of the target node being inhibited).
The TD values are $TD_{AND-NOT,1+4}=0.03$, $TD_{OR-NOT,1+4}=0.53$ and so the percent agreement between the `AND-NOT` parameterization and the resulting $0$ stable state activity is justified, but for the `OR-NOT` cases we would expect around half of them to be in agreement (have a value of $1$ in the stable state) - which was not the case (all of them had $0$).
Probably the network dynamical configuration may have something to do with that.
:::

```{r lo-stats-table}
caption.title = "Link Operator Statistics (CASCADE 1.0)"
DT::datatable(data = node_stats %>% select(node, num_reg, num_act, num_inh), 
  caption = htmltools::tags$caption(caption.title, style="color:#dd4814; font-size: 18px"),
  options = list(order = list(list(2, "desc"))))
```

# CASCADE 2.0 Data Analysis {-}

:::{.blue-box}
We will perform the same analysis as in the previous section, only now for a **randomly selected sample of models from the CASCADE 2.0 topology**.

CASCADE 2.0 represents a larger topology/network with nodes with more than $5$ regulators and as such we expect to see even more agreement between stable state activity and link operator assignment for these nodes (which will be a proof-of-concept for the link operator bias).
:::

## Data {-}

:::{.note}
The dataset used was generated for [another analysis](https://bblodfon.github.io/gitsbe-model-analysis/cascade/random-model-ss/main.html) and we are going to use part of it, i.e. the **models that had 1 stable state** (see [get_node_stats_cascade_2.R](https://github.com/bblodfon/brf-bias/blob/main/scripts/get_node_stats_cascade_2.R) script).
The dataset is stored in Zenodo [![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.3932382.svg)](https://doi.org/10.5281/zenodo.3932382)
:::

Load the CASCADE 2.0 `node_stats_cascade2`:
```{r load-node-stats-cascade2}
node_stats_cascade2 = readRDS(file = "data/node_stats_cascade2.rds")
```

## Parameterization vs Activity {-}

The next Figure shows the **total percent agreement** for each link operator node in CASCADE 2.0 (a total of $52$ nodes), which is the number of models for which **parameterization and stable state matched** divided by the total amount of models ($20672$):
```{r ss-lo-prop-aggreement-cascade2, fig.align='center', dpi=300, cache=TRUE, fig.cap='Parameterization and Stable State activity agreement (CASCADE 2.0)'}
node_stats_cascade2 %>% mutate(node = forcats::fct_reorder(node, desc(num_reg))) %>% 
  ggplot(aes(x = node, y = obs_prop_agreement, fill = as.factor(num_reg))) +
    geom_bar(stat = "identity") +
    scale_y_continuous(labels=scales::percent) +
    labs(title = "Agreement between Link Operator Parameterization and Stable State Activity", x = "Target Nodes with both activating and inhibiting regulators", y = "Percent Agreement") +
    theme_classic() + theme(axis.text.x = element_text(angle = 90)) +
    scale_fill_brewer(guide = guide_legend(reverse=TRUE, title = "#Regulators"), palette = "Spectral") +
    geom_hline(yintercept = 0.5, linetype = 'dashed')
```
:::{.green-box}
The total barplot area covered (i.e. the **total agreement score** so to speak) is **`r node_stats_cascade2 %>% summarise(100 * sum(obs_prop_agreement)/n()) %>% pull()`%**.
:::

In the next two figures, we separate the nodes to $3$ groups based on the number of regulators they have and show both the percent agreement and Cohen's $\kappa$ statistic (see [note](#percent-agreement-note)):
```{r ss-lo-prop-aggreement-cascade2-grouped, fig.align='center', fig.show='hold', out.width='50%', dpi=300, cache=TRUE, fig.cap='Parameterization and Stable State activity agreement. CASCADE 2.0 link operator nodes are grouped based on their respective number of regulators'}
node_stats_cascade2 %>% mutate(reg_group = 
    factor(case_when(num_reg >= 6 ~ ">5", num_reg <= 3 ~ "2-3", TRUE ~ "4-5"), levels = c("2-3", "4-5", ">5"))) %>%
  ggplot(aes(x = reg_group, y = obs_prop_agreement, fill = reg_group)) + 
    geom_boxplot(show.legend = FALSE) +
    geom_jitter(shape = 19, position = position_jitter(0.2), show.legend = FALSE) +
    scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
    labs(title = "Agreement (parameterization vs stable state activity)", x = "Number of Regulators", y = "Percent Agreement") +
    geom_hline(yintercept = 0.5, linetype = 'dashed', color = "red") +
    theme_classic(base_size = 14) +
    theme(axis.text.x = element_text(size = 15))

node_stats_cascade2 %>% mutate(reg_group = 
    factor(case_when(num_reg >= 6 ~ ">5", num_reg <= 3 ~ "2-3", TRUE ~ "4-5"), levels = c("2-3", "4-5", ">5"))) %>%
  ggplot(aes(x = reg_group, y = cohen_k, fill = reg_group)) + 
    geom_boxplot(show.legend = FALSE) +
    geom_jitter(shape = 19, position = position_jitter(0.2), show.legend = FALSE) +
    ylim(c(0,1)) +
    labs(title = "Cohen's k (parameterization vs stable state activity)", x = "Number of Regulators", y = latex2exp::TeX("$\\kappa$")) +
    geom_hline(yintercept = 0.6, linetype = 'dashed', color = "red") +
    geom_text(aes(x = 3.4, y = 0.55, label="k = 0.6")) + 
    theme_classic(base_size = 14) +
    theme(axis.text.x = element_text(size = 15))
```

:::{.green-box}
The nodes with number of regulators $>5$ have always a percent agreement $\geq 75\%$ between stable state activity and link operator parameterization and $\kappa_{median}>0.6$.
The above results provide evidence that the statistics-based conclusion we reached in a [previous section](#stand-eq-bias) is correct, i.e. that the **standardized boolean formula is biased for larger number of regulators**.
:::

# Random scale-free Networks Analysis {-}

## Method {-}

:::{.green-box}
```{r, fig.cap="Methodology Overview"}
knitr::include_graphics(path = "img/scale_free_methodology.png")
```
:::

- We generate the scale-free topology `.sif` files with the script [random_topo_gen.R](https://github.com/bblodfon/brf-bias/blob/main/scripts/random_topo_gen.R) - implementation was based on the BoolNet R package [@Mussel2010].
The input degree distribution of the scale-free networks follows Riemann's Zeta function [@Aldana2003].
- We use the [abmlog](https://github.com/druglogics/abmlog/releases/tag/v1.6.0) software to produce every possible link operator parameterized boolean model out of every topology file created in the previous step.
The more link operator equations the network topology has (target nodes with both *activating* and *inhibiting* regulators) the more boolean models are generated (see script [run_abmlog_topology_files.sh](https://github.com/bblodfon/brf-bias/blob/main/scripts/run_abmlog_topology_files.sh)).
- We analyze the data from all the abmlog-produced models and **compare stable state and link operator assignment** and produce agreement statistics (see script [get_scale_free_model_stats.R](https://github.com/bblodfon/brf-bias/blob/main/scripts/get_scale_free_model_stats.R))

:::{.note}
Most of the scale-free networks studied in literature have $\gamma\in[2,2.5]$ - see **Fig. 5** in [@Aldana2003].
:::

## Topology Stats {-}

Some statistics on the scale-free network topologies produced:
```{r, fig.cap="Scale-free networks Topology statistics", fig.show='hold', out.width='50%'}
knitr::include_graphics(path = "img/lo_eq_density.png")
knitr::include_graphics(path = "img/max_reg_density.png")
```

:::{.green-box}
- $\gamma=2$ provides networks with statistically **more link operator nodes (targeted by both positive and negative regulators)** and thus these topologies will produce more boolean models via `abmlog`, so **more stable state data** to compare with the respective parameterization.
- We also observe for both $\gamma$'s the presence of **link operator nodes with high numbers of regulators** which is exactly what we needed from the dataset to test if the standardized regulatory functions are biased or not.
- $\gamma=2$ also provides networks with statistically **higher in-degree for the largest hub-nodes** and thus present **better candidates** for testing the truth density bias of the standardized boolean regulatory functions, which manifests especially for nodes with high input-degree (e.g. $\ge 8$)
:::

## Boolean Model Stats {-}

Some statistics regarding the abmlog-produced boolean models and their respective stable states:
```{r, fig.show='hold', out.width='50%'}
knitr::include_graphics(path = "img/ss_dist.png")
knitr::include_graphics(path = "img/ss_dist_total_sum.png")
```

```{r, fig.cap="Stable state statistics", fig.show='hold', out.width='50%'}
knitr::include_graphics(path = "img/zero_ss_dist.png")
```

:::{.green-box}
- **More stable state data** for $\gamma=2$, even though we had $\times10$ more scale-free networks produced with $\gamma=2.5$.
- $\approx 50\%$ of the scale-free topologies that pass through `abmlog` and produce all possible link operator parameterized boolean models, **do not have any model with a stable state**.
:::

## Parameterization vs Activity {-}

```{r load-scale-free-stats-data}
sf_stats_g2_5 = readRDS(file = "data/sf_stats_gamma2.5.rds")
sf_stats_g2 = readRDS(file = "data/sf_stats_gamma2.rds")
```

We will **organize the link operator nodes on separate groups** based on the number of regulators they have and compare nodes coming from different-$\gamma$ scale-free topologies in separate sections/figures.

For the agreement statistics we will use the **percent agreement** and Cohen's $\kappa$ as before (see [note](#percent-agreement-note)).

### Results for networks with $\gamma = 2$ {-}

```{r agree-stats-g2, warning=FALSE, cache=TRUE, dpi=300, fig.show='hold', out.width='50%', fig.cap='Link operator Parameterization vs Stable State Activity for scale-free topologies with $\\gamma$ = 2'}
sf_stats_g2 = 
  sf_stats_g2 %>% mutate(reg_group = factor(case_when(
  num_reg %in% 2:3 ~ "2-3", 
  num_reg %in% 4:6 ~ "4-6", 
  num_reg %in% 7:10 ~ "7-10", 
  num_reg %in% 11:14 ~ "11-14", 
  num_reg %in% 15:20 ~ "15-20",
  TRUE ~ ">20"), levels = c("2-3", "4-6", "7-10", "11-14", "15-20", ">20"))) 

sf_stats_g2 %>%
  ggplot(aes(x = reg_group, y = percent_agreement, fill = reg_group)) + 
  geom_boxplot(show.legend = FALSE) +
  scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
  labs(title = latex2exp::TeX("Agreement (parameterization vs stable state activity) - $\\gamma$ = 2"), x = "Number of Regulators", y = "Percent Agreement") +
  geom_hline(yintercept = 0.5, linetype = 'dashed', color = "red") +
  theme_classic(base_size = 14) +
  theme(axis.text.x = element_text(size = 15))

sf_stats_g2 %>%
  ggplot(aes(x = reg_group, y = cohen_k, fill = reg_group)) + 
  geom_boxplot(show.legend = FALSE) +
  scale_y_continuous(limits = c(0,1)) +
  labs(title = latex2exp::TeX("Cohen's k (parameterization vs stable state activity) - $\\gamma$ = 2"), x = "Number of Regulators", y = latex2exp::TeX("$\\kappa$")) +
  geom_hline(yintercept = 0.6, linetype = 'dashed', color = "red") +
  geom_text(aes(x = 6, y = 0.55, label="k = 0.6")) + 
  theme_classic(base_size = 14) +
  theme(axis.text.x = element_text(size = 15))
```

### Results for networks with $\gamma = 2.5$ {-}

```{r agree-stats-g2-5, warning=FALSE, cache=TRUE, dpi=300, fig.show='hold', out.width='50%', fig.cap='Link operator Parameterization vs Stable State Activity for scale-free topologies with $\\gamma$ = 2.5'}
sf_stats_g2_5 = sf_stats_g2_5 %>% mutate(reg_group = factor(case_when(
  num_reg %in% 2:3 ~ "2-3", 
  num_reg %in% 4:6 ~ "4-6", 
  num_reg %in% 7:10 ~ "7-10", 
  num_reg %in% 11:14 ~ "11-14", 
  num_reg %in% 15:20 ~ "15-20",
  TRUE ~ ">20"), levels = c("2-3", "4-6", "7-10", "11-14", "15-20", ">20"))) 

sf_stats_g2_5 %>%
  ggplot(aes(x = reg_group, y = percent_agreement, fill = reg_group)) + 
  geom_boxplot(show.legend = FALSE) +
  scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
  labs(title = latex2exp::TeX("Agreement (parameterization vs stable state activity) - $\\gamma$ = 2.5"), x = "Number of Regulators", y = "Percent Agreement") +
  geom_hline(yintercept = 0.5, linetype = 'dashed', color = "red") +
  theme_classic(base_size = 14) +
  theme(axis.text.x = element_text(size = 15), plot.title = element_text(size = 16))

sf_stats_g2_5 %>%
  ggplot(aes(x = reg_group, y = cohen_k, fill = reg_group)) + 
  geom_boxplot(show.legend = FALSE) +
  scale_y_continuous(limits = c(0,1)) +
  labs(title = latex2exp::TeX("Cohen's k (parameterization vs stable state activity) - $\\gamma$ = 2.5"), x = "Number of Regulators", y = latex2exp::TeX("$\\kappa$")) +
  geom_hline(yintercept = 0.6, linetype = 'dashed', color = "red") +
  geom_text(aes(x = 6, y = 0.55, label="k = 0.6")) + 
  theme_classic(base_size = 14) +
  theme(axis.text.x = element_text(size = 15), plot.title = element_text(size = 16))
```

:::{.green-box}
Results for both $\gamma$'s show the same thing: **the higher the number of regulators, the more biased the boolean link operator function result is**.

Specifically, for both $\gamma$'s, we observe that for $n>7-10$ regulators, assigning a node the `AND-NOT` link operator in its corresponding equation, results in it having a stable state equal to $0$ and vice-versa for the `OR-NOT` case.
:::

```{r, kmeans-cl-reg-group-g2, include=FALSE, eval=FALSE, warning=FALSE}
set.seed(42)
k = 7 # how many groups to split?

num_reg_vec = sf_stats_g2 %>% pull(num_reg)
cl = kmeans(x = num_reg_vec, centers = k)

cl_sort = cl$centers %>% sort(index.return=TRUE)

sf_stats_g2_new = sf_stats_g2 %>% 
  tibble::add_column(reg_group = factor(cl$cluster, levels = cl_sort$ix)) 

# find the regulatory group ranges from the clustering (in terms of number of regulators)
group_ranges = sf_stats_g2_new %>% 
  group_by(reg_group) %>% 
  summarize(min = min(num_reg), max = max(num_reg)) %>% 
  tidyr::unite(col = "group_ranges", min:max, sep = "-") %>% 
  pull(group_ranges)

# Percent agreement per group
sf_stats_g2_new %>% 
  ggplot(aes(x = num_reg, y = percent_agreement, fill = reg_group)) + 
  geom_boxplot(show.legend = FALSE) +
  scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
  scale_x_continuous(labels = group_ranges, breaks = sort(cl$centers)) +
  labs(title = latex2exp::TeX("Agreement (parameterization vs stable state activity) - $\\gamma$ = 2"), x = "Number of Regulators", y = "Percent Agreement") +
  geom_hline(yintercept = 0.5, linetype = 'dashed', color = "red") +
  theme_classic(base_size = 14) +
  theme(axis.text.x = element_text(size = 15))

# Cohen's k per group
sf_stats_g2_new %>% 
  ggplot(aes(x = num_reg, y = cohen_k, fill = reg_group)) + 
  geom_boxplot(show.legend = FALSE) +
  scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
  scale_x_continuous(labels = group_ranges, breaks = sort(cl$centers)) +
  labs(title = latex2exp::TeX("Cohen's k (parameterization vs stable state activity) - $\\gamma$ = 2"), x = "Number of Regulators", y = latex2exp::TeX("$\\kappa$")) +
  geom_hline(yintercept = 0.6, linetype = 'dashed', color = "red") +
  geom_text(aes(x = 39, y = 0.55, label="k = 0.6")) + 
  theme_classic(base_size = 14) +
  theme(axis.text.x = element_text(size = 15))
```

# R session info {-}

```{r session info, comment=""}
xfun::session_info()
```

# References {-}
